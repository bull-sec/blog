# SNMP

SNMP - Simple Network Management Protocol is a protocol used to monitor different devices in the network (like routers, switches, printers, IoTs...)

We can potentially get a lot of information from SNMP depending on what is configured. It is a very verbose protocol.

---

## Versions

- v1: Most common, uses strings for authentication (all in plaintext)
- v2 & v2c: Same as v1 essentially, but slightly different protocol
- v3: Much better authentication and it's even encrypted

## Enumeration

Before you start you'll need these installed:

```bash
apt install snmp
apt install snmp-mibs-downloader

# run the downloader
download-mibs
```

```bash
# Basic check
snmp-check $ip

# Check a list of community strings
onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt $ip -w 100

# Walk the SNMP server
snmpwalk -v $snmp_version -c $comm_string $ip

# Get extended objects
snmpwalk -v $snmp_version -c $comm_string $ip NET-SNMP-EXTEND-MIB::nsExtendObjects

# Enumerate extended queries/functionality
snmpwalk -v $snmp_version -c $comm_string $ip NET-SNMP-EXTEND-MIB::nsExtendOutputFull

# Automated scanning with nmap
nmap --script "snmp* and not snmp-brute" $ip

# If all else fails, brutefoce the community string
hydra -P /usr/share/wordlists/rockyou.txt -v $ip snmp
```

It's worth dumping the output to a file for further inspection using `grep` to look for additional information.

```bash
# find failed logins/passwords
grep -i "login\|fail" *.snmp

grep -i "trap" *.snmp
# find emails
grep -E -o "\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}\b" *.snmp
```

### Braa

Mass snmp enumeration tool. Braa implements its OWN snmp stack, so it does NOT need any SNMP libraries like net-snmp.

```bash
/home/kali/Tools/braa

https://github.com/mteg/braa
```

> Syntax: braa [Community-string]@[IP of SNMP server]:[iso id]

`braa ignite123@192.168.1.125:.1.3.6.*`


---

## Found the Config File?

Generally called `snmp.conf`, you'll find it generally in the `/etc` folder, but it could be anywhere so it's worth keeping an eye out for.

Look at the any strings that start `ro` or `rw`, they are generally the rules for the community strings. `rwcommunity` would be a Read/Write rule on whatever string followed, usually something that will *look* like a password.

> Any private community string may also be a password. People are bad with reusing passwords



## RCE

Yes we can get RCE from SNMP.

In short there is a way to "extend" the functionality and this can in some cases lead to us being able to gain code execution on the device.

[HackTricks Book](https://book.hacktricks.xyz/pentesting/pentesting-snmp/snmp-rce)


