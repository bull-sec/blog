
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>SMB - Port 139 &amp; 445 &#8212; The InfoSec Bible</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="SNMP - Port 161" href="161_snmp.html" />
    <link rel="prev" title="Ident - Port 113" href="113_ident.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The InfoSec Bible</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Welcome to the JankYard™
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pentesting
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   Penetration Testing
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../groundwork/index.html">
     000 - Ground Work
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../groundwork/notetaking.html">
       Note Taking
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../groundwork/learning.html">
       Learning Links
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../groundwork/methodology.html">
       General Methodology
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../groundwork/legal.html">
       Legal Stuff
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../passiverecon/index.html">
     001 - Passive Recon (OSINT)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../passiverecon/googledorks.html">
       Google Dorks
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../passiverecon/git.html">
       GitHub/Git
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../passiverecon/shodan.html">
       Shodan.io
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../activerecon/index.html">
     002 - Active Recon
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../activerecon/portscanning.html">
       Port Scanning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../activerecon/fuzzing.html">
       Fuzzing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     003 Service Enumeration
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="../vulnscanning.html">
       Vulnerability Scanning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="7_echo.html">
       Echo - Port 7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="21_ftp.html">
       FTP - Port 21
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="22_ssh.html">
       SSH - Port 22
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="23_telnet.html">
       Telnet - Port 23
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="25_smtp.html">
       SMTP - Port 25
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="53_dns.html">
       DNS - Port 53
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="69_tftp.html">
       TFTP - Port 69
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="88_kerberos.html">
       Kerberos - Port 88
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="110_pop.html">
       POP - Port 110
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="113_ident.html">
       Ident - Port 113
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       SMB - Port 139 &amp; 445
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="161_snmp.html">
       SNMP - Port 161
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="3128_squid.html">
       Squid - Port 3128
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../webexploitation/index.html">
     004 - Web Exploitation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../webexploitation/xss.html">
       XSS - Cross Site Scripting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../webexploitation/sqli.html">
       SQL Injection
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../foothold/index.html">
     005 - Foothold
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../foothold/filetransfers.html">
       Transfering Files 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../foothold/pivot.html">
       Pivotting 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../foothold/x_without_y.html">
       X Without Y
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../privesc/index.html">
     006 - Privilege Escalation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../privesc/linux/index.html">
       Linux PrivEsc
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
      <label for="toctree-checkbox-9">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../privesc/linux/101.html">
         Linux 101
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../privesc/linux/bash101.html">
         Bash Programming 101
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../privesc/linux/memes.html">
         Linux Memes
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../privesc/linux/privesc.html">
         Linux Privilege Escalation
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../privesc/windows/index.html">
       Windows PrivEsc
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../privesc/windows/101.html">
         Windows 101
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../privesc/windows/bluthund.html">
         BloodHound 101
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../privesc/windows/powershell101.html">
         PowerShell for Pentesters
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  BugBounty
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../bugbounty/bugbounty.html">
   BugBounties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../bugbounty/bugbounty_automation.html">
     Automating BugBounty
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../bugbounty/bugbounty_tips.html">
     BugBounty Tips
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Cheatsheets/Playbooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../testbook.html">
   Notebook Example
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CyberDefenders.org
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../cyberdefenders/index.html">
   CyberDefenders.org
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../cyberdefenders/blueteam.html">
     BlueTeam Training
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CTFS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../ctfs/hackthebox/index.html">
   HackTheBox.eu
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../ctfs/hackthebox/easy/index.html">
     HTB - Easy Boxes
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../ctfs/hackthebox/easy/easybox.html">
       EASY BOX
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../ctfs/hackthebox/medium/index.html">
     HTB - Medium Boxes
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../ctfs/hackthebox/medium/mediumbox.html">
       MEDIUM BOX
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../ctfs/hackthebox/hard/index.html">
     HTB - Hard Boxes
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../ctfs/hackthebox/hard/hardbox.html">
       HARD BOX
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../ctfs/hackthebox/insane/index.html">
     HTB - Insane
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../ctfs/hackthebox/insane/insanebox.html">
       INSANE BOX
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/pentesting/serviceenum/protocols/139-445_smb.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpentesting/serviceenum/protocols/139-445_smb.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#enumerating-smb">
   Enumerating SMB
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#known-vulnerabilities">
   Known Vulnerabilities
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bruteforcing">
   Bruteforcing
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="smb-port-139-445">
<h1>SMB - Port 139 &amp; 445<a class="headerlink" href="#smb-port-139-445" title="Permalink to this headline">¶</a></h1>
<p>SMB stands for Serial Message Bus, it’s a protocol, it’s used to store files. There have been a bucket load of vulnerabilities for various versions over the years, with probably the most high profile being <code class="docutils literal notranslate"><span class="pre">MS17-010</span></code> otherwise known as <code class="docutils literal notranslate"><span class="pre">EternalBlue</span></code> which was part of the files which were leaked from the NSA along with a bunch of their internal tooling.</p>
<p>OK, that’s the admin done.</p>
<hr class="docutils" />
<section id="enumerating-smb">
<h2>Enumerating SMB<a class="headerlink" href="#enumerating-smb" title="Permalink to this headline">¶</a></h2>
<p>Enumerate the hostname: <code class="docutils literal notranslate"><span class="pre">nmblookup</span> <span class="pre">-A</span> <span class="pre">ip</span></code></p>
<p>Look for null/anonymous sessions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">smbmap</span> <span class="pre">-H</span> <span class="pre">ip/hostname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rpcclient</span> <span class="pre">-U</span> <span class="pre">&quot;&quot;</span> <span class="pre">-N</span> <span class="pre">ip</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smbclient</span> <span class="pre">\\\\ip\\share</span></code></p></li>
</ul>
<p>List available shares:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">smbmap</span> <span class="pre">-H</span> <span class="pre">ip/hostname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">exit</span> <span class="pre">|</span> <span class="pre">smbclient</span> <span class="pre">-L</span> <span class="pre">\\\\ip</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmap</span> <span class="pre">--script</span> <span class="pre">smb-enum-shares</span> <span class="pre">-p</span> <span class="pre">139,445</span> <span class="pre">ip</span></code></p></li>
</ul>
<p>Check for vulnerabilities:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nmap</span> <span class="pre">--script</span> <span class="pre">smb-vuln*</span> <span class="pre">-p</span> <span class="pre">139,445</span> <span class="pre">ip</span></code></p></li>
</ul>
<p>If you’re having trouble getting the version you can often get it from <code class="docutils literal notranslate"><span class="pre">wireshark</span></code> or <code class="docutils literal notranslate"><span class="pre">tcpdump</span></code>, just send a request to the server and check out the TCP stream and it should have some additional information in there for you.</p>
<p>One of the guis on the PWK forums wrote the following to check for the version:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="c1">#Author: rewardone</span>
<span class="c1">#Description:</span>
<span class="c1"># Requires root or enough permissions to use tcpdump</span>
<span class="c1"># Will listen for the first 7 packets of a null login</span>
<span class="c1"># and grab the SMB Version</span>
<span class="c1">#Notes:</span>
<span class="c1"># Will sometimes not capture or will print multiple</span>
<span class="c1"># lines. May need to run a second time for success.</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> <span class="s2">&quot;Usage: ./smbver.sh RHOST {RPORT}&quot;</span> <span class="o">&amp;&amp;</span> exit<span class="p">;</span> <span class="k">else</span> <span class="nv">rhost</span><span class="o">=</span><span class="nv">$1</span><span class="p">;</span> <span class="k">fi</span>
<span class="k">if</span> <span class="o">[</span> ! -z <span class="nv">$2</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nv">rport</span><span class="o">=</span><span class="nv">$2</span><span class="p">;</span> <span class="k">else</span> <span class="nv">rport</span><span class="o">=</span><span class="m">139</span><span class="p">;</span> <span class="k">fi</span>
tcpdump -s0 -n -i tap0 src <span class="nv">$rhost</span> and port <span class="nv">$rport</span> -A -c <span class="m">7</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> grep -i <span class="s2">&quot;samba\|s.a.m&quot;</span> <span class="p">|</span> tr -d <span class="s1">&#39;.&#39;</span> <span class="p">|</span> grep -oP <span class="s1">&#39;UnixSamba.*[0-9a-z]&#39;</span> <span class="p">|</span> tr -d <span class="s1">&#39;\n&#39;</span> <span class="p">&amp;</span> <span class="nb">echo</span> -n <span class="s2">&quot;</span><span class="nv">$rhost</span><span class="s2">: &quot;</span> <span class="p">&amp;</span>
<span class="nb">echo</span> <span class="s2">&quot;exit&quot;</span> <span class="p">|</span> smbclient -L <span class="nv">$rhost</span> <span class="m">1</span>&gt;/dev/null <span class="m">2</span>&gt;/dev/null
sleep <span class="m">0</span>.5 <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="known-vulnerabilities">
<h2>Known Vulnerabilities<a class="headerlink" href="#known-vulnerabilities" title="Permalink to this headline">¶</a></h2>
</section>
<section id="bruteforcing">
<h2>Bruteforcing<a class="headerlink" href="#bruteforcing" title="Permalink to this headline">¶</a></h2>
<p>Saved this til last, and not because it’s the best, but because it probably should be a last resort. Bruteforcing is just that, it’s brute and it’s based and we should always strive to be smarter not just more persistent. Although there is something to be said for an approach which favours the latter.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pentesting/serviceenum/protocols"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="113_ident.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ident - Port 113</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="161_snmp.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">SNMP - Port 161</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By AppSec<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>